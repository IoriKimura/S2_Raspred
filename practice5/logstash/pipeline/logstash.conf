input {
  beats {
    port => 5044 # принимаем события от Filebeat/Metricbeat
  }

  http {
    port => 8080              # даём возможность послать лог обычным HTTP POST
    codec => json             # ожидаем JSON, удобно тестировать через curl
  }

  stdin {
    type => "manual-test"     # fallback-ввод, можно писать прямо в консоль контейнера
  }
}

filter {
  # Пока фильтров нет, блок оставляем для будущих преобразований
}

output {
  elasticsearch {
    hosts => ["http://elasticsearch:9200"] # отправляем документы в Elasticsearch
    user => "${ELASTIC_USER}"              # учетные данные подтягиваются из окружения контейнера
    password => "${ELASTIC_PASSWORD}"
    index => "host-logs-%{+YYYY.MM.dd}"    # создаём новый индекс каждый день
  }

  stdout {
    codec => rubydebug # дублируем вывод в консоль для отладки
  }
}

